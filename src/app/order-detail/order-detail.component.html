<app-header titleInput="Regiestunden"></app-header>

<div id="detail-component-wrapper">
  <div class="sub-nav">
    <div class="sub-nav-btn">
      <mat-icon
        (click)="navigateToOrderList()"
        class="navigate-before-icon float-left"
        >navigate_before</mat-icon
      >
    </div>
    <button type="button" class="sub-nav-btn" (click)="openPrintDialog()">
      <mat-icon class="print-icon float-right">print</mat-icon>
    </button>
  </div>

  <div class="order-detail-title"></div>

  <div id="detail-component-content">
    <div id="customer-info" class="clearfix">
      <div id="customer-info-wrapper" class="clearfix">
        <div id="customer-info-wrapper-left" class="float-left">
          <div id="order-date" class="clearfix">
            <mat-icon
              class="float-left"
              aria-hidden="false"
              aria-label="date icon"
            >
              date_range
            </mat-icon>
            <div class="float-left icon-margin">
              {{ order?.date.toDate() | date: "dd.MM.yyyy" }}
            </div>
          </div>

          <div id="order-customer" class="clearfix">
            <mat-icon
              class="float-left"
              aria-hidden="false"
              aria-label="company name icon"
            >
              perm_identity
            </mat-icon>
            <div class="float-left icon-margin">
              {{ order?.companyName }}
            </div>
          </div>
        </div>
        <div id="customer-info-wrapper-right" class="float-left">
          <div id="order-location" class="clearfix">
            <mat-icon
              class="float-left"
              aria-hidden="false"
              aria-label="location icon"
            >
              location_on
            </mat-icon>

            <div class="float-left icon-margin">
              {{ order?.location }}
            </div>
          </div>
          <div id="order-contact-person" class="clearfix">
            <img
              id="helmet-icon"
              class="float-left"
              src="./assets/img/helmet.svg"
              alt="contact person icon"
            />
            <div class="float-left icon-margin">
              {{ order?.contactPerson }}
            </div>
          </div>
        </div>
      </div>
    </div>

    <div>
      <strong> </strong>
    </div>

    <div class="order-detail-table-wrapper">
      <mat-table
        #table
        [dataSource]="dataSource"
        matSort
        *ngIf="hasRecordsFound; else noRecordsFoundTemplate"
      >
        <!-- Checkbox Column -->
        <ng-container matColumnDef="select">
          <mat-header-cell *matHeaderCellDef>Drucken</mat-header-cell>
          Drucken
          <mat-checkbox
            (change)="$event ? masterToggle() : null"
            [checked]="selection.hasValue() && isAllSelected()"
            [indeterminate]="selection.hasValue() && !isAllSelected()"
          >
          </mat-checkbox>
          <td mat-cell *matCellDef="let row">
            <mat-checkbox
              (click)="$event.stopPropagation()"
              (change)="$event ? selection.toggle(row) : null"
              [checked]="selection.isSelected(row)"
              [disabled]="row.excluded"
            >
              <!-- *ngIf="!row.excluded" -->
            </mat-checkbox>
          </td>
        </ng-container>

        <ng-container matColumnDef="id">
          <mat-header-cell *matHeaderCellDef> Id</mat-header-cell>
          <mat-cell *matCellDef="let element">
            <div>Id:</div>
            {{ element.id }}
          </mat-cell>
        </ng-container>

        <ng-container matColumnDef="date">
          <mat-header-cell *matHeaderCellDef> Datum</mat-header-cell>
          <mat-cell *matCellDef="let element">
            <div class="disable-on-mobile">
              {{ element?.date | date: "dd.MM.yyyy" }}
            </div>
            <mat-form-field>
              <input
                matInput
                placeholder="Datum"
                value="{{ element?.date | date: 'dd.MM.yyyy' }}"
                readonly
              />
            </mat-form-field>
          </mat-cell>
        </ng-container>

        <ng-container matColumnDef="description">
          <mat-header-cell *matHeaderCellDef>Beschreibung </mat-header-cell>
          <mat-cell *matCellDef="let element">
            <div class="disable-on-mobile">{{ element.description }}</div>
            <mat-form-field>
              <input
                matInput
                placeholder="Beschreibung"
                value="{{ element.description }}"
                readonly
              />
            </mat-form-field>
          </mat-cell>
        </ng-container>

        <ng-container matColumnDef="workingHours">
          <mat-header-cell *matHeaderCellDef> Arbeitsstunden </mat-header-cell>
          <mat-cell *matCellDef="let element">
            <div class="disable-on-mobile">{{ element.workingHours }}</div>
            <mat-form-field>
              <input
                matInput
                placeholder="Arbeitsstunden"
                value="{{ element.workingHours }}"
                readonly
              />
            </mat-form-field>
          </mat-cell>
        </ng-container>

        <ng-container matColumnDef="employee">
          <mat-header-cell *matHeaderCellDef> Arbeiter </mat-header-cell>
          <mat-cell *matCellDef="let element">
            <div class="disable-on-mobile">{{ element.employee }}</div>
            <mat-form-field>
              <input
                matInput
                placeholder="Arbeiter"
                value="{{ element.employee }}"
                readonly
              />
            </mat-form-field>
          </mat-cell>
        </ng-container>

        <!-- Exclude Column -->
        <ng-container id="column-excluded" matColumnDef="excluded">
          <th mat-header-cell *matHeaderCellDef>Excluded</th>
          <td mat-cell *matCellDef="let element">{{ element.excluded }}</td>
        </ng-container>

        <mat-header-row *matHeaderRowDef="displayedColumns"></mat-header-row>
        <!-- !row.excluded will prevent those rows from being clicked -->
        <mat-row
          *matRowDef="let row; columns: displayedColumns"
          (click)="highlighted.toggle(row); showEditAndDeleteButton(row)"
          [ngClass]="{
            hovered: row.hovered,
            highlighted: highlighted.isSelected(row)
          }"
          (click)="!row.excluded && selection.toggle(row)"
          [ngStyle]="row.excluded && { 'background-color': 'lightgrey' }"
        ></mat-row>
      </mat-table>

      <ng-template #noRecordsFoundTemplate>
        Keine Eintr√§ge gefunden
      </ng-template>

      <!-- <mat-row *matRowDef="let row; columns: displayedColumns"></mat-row> -->
    </div>
  </div>
</div>

<div id="bottom-nav">
  <div *ngIf="showButtonsIfRecordIsSelected">
    <button
      type="button"
      id="create-record-edit-btn"
      type="button"
      mat-fab
      (click)="editRecord(this.selectedRecord)"
    >
      <i class="material-icons">edit</i>
    </button>
  </div>

  <div *ngIf="showButtonsIfRecordIsSelected">
    <button
      *ngIf="showButtonsIfRecordIsSelected"
      type="button"
      id="create-record-delete-btn"
      type="button"
      mat-fab
      (click)="deleteRecord(this.selectedRecord)"
    >
      <i class="material-icons">delete</i>
    </button>
  </div>
  <button
    type="button"
    id="create-record-btn"
    type="button"
    mat-fab
    (click)="createNewRecord()"
  >
    <i class="material-icons">add</i>
  </button>
</div>
